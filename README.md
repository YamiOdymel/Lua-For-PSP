本文由gadget2k翻譯自http://www.evilmana.com/tutorials/lua_tutorial_01.php的網路上教學，轉載請註明。想進一步深造的，請學習下面的《Programming in Lua》（點此下載），這是對Lua的全面闡述。

# 1——起跑前的準備工作

本系列教學旨在幫助完全的編程新手學會使用lua腳本語言為PSP開發小型程式和遊戲。在開始之前我們需要做一些準備工作，雖然不都是非要不可，但是有了它們你會事半功倍。

譯者註：本教學全部學完了你也就是會爬而已。要學會走，甚至跑起來，就看你的熱情和毅力了！

LuaPlayer for PSP - 這是頭等大事，沒有它你的lua腳本就無法在PSP上執行。點此下載

LuaPlayer for Windows - 這是在PC上執行的LuaPlayer，寫好了腳本可以先在PC上檢驗，省得為了測試而在PC和PSP之間來回倒騰檔案。點此下載

> 譯者注1：該PC版本基於luaPlayer 0.20，LuaPlayer HM 5.0支援的新函數可能無法執行。

> 譯者注2：鍵盤與PSP按鍵的對應。SELECT = a，START = s，LTRIGGER = q，RTRIGGER = w，TRIANGLE = r，CIRCLE = f，CROSS = c，SQUARE = d，十字鍵 = 方向鍵

Notepad++ - 比windows自帶的notepad要強悍多的開源免費文本編輯器，可以高亮顯示多種程式語言，還具備自動完成功能，自動對程式碼樹級管理。點此下載

當然你也可以使用其他任何文本編輯器編寫腳本，包括Notepad。 （以前推薦的miro lua不如這個強，刪除。）

Windows版LuaPlayer的使用

解壓luaPlayerWindows.rar至硬碟。在luaplayer.exe所在目錄下，建立一個文本檔案，內容是

```
luaplayer script.lua
pause
```

將其存為script.cmd，確保不要存成txt後綴。這樣可以方便在PC上執行你的程式。其中luaplayer是指所在資料夾的luaplayer.exe，而script.lua則是你編寫的程式檔案名。Pause則是保證發生錯誤時命令列視窗不會關閉。這樣我們就可以為程式捉蟲。

注意：如果雙擊script.cmd檔案出現下述錯誤

> 'luaplayer' is not recognized as an internal or external command, operable program or batch file

那麼就用luaplayer.exe的全路徑替代luaplayer。例如：

```
"C:\Documents and Settings\Owner\Desktop\mygame\luaplayer.exe" 
script.lua
pause
```

現在我們使用Notepad（或者其他任何編輯器，例如ConTEXT） 再建一個文本檔案，命名為script.lua（註：如果你嘗試在PSP上執行該腳本發生“腳本未找到”錯誤時你可能需要將其改名為index.lua）。我們暫時就留空，下一講我們會讓你在其中編寫程式碼並測試它的。以後要讓Windows版LuaPlayer執行你的程式碼，很簡單，只要雙擊script.cmd檔案就行了。

# 2——編寫你的第一個Lua程序

現在我們開始為PSP編寫自己的第一個Lua程序。請謹記我們在整個教學中都會利用到LuaPlayer的Windows版，雖然有些東西在windows版上不能很好運行（例如音訊不是很好），甚或不能運行（例如LuaPlayer新增的一些函數），但是對於我們將要學習的東西來說，windows版還是足夠使用的。

LuaPlayer在PSP上的安裝一般來說把LuaPlayer文件夾放在PSP/GAME目錄下皆可。

任何時候你想要在PSP上測試你的程序的話，只要把你的script.lua文件複製到EBOOT.PBP所在目錄下，然後運行LuaPlayer即可。

首先用文本編輯器打開你的script.lua文件。我們的第一個程序很簡單，就是在螢幕上列印一些東西。讓我們開始吧！

## 註釋

我們第一件要學的就是如何給你的代碼做註釋。註釋是為了幫助其他人看懂你的代碼。相信我，這也能幫助你自己。在你停止一個項目幾個月後再回頭看自己的代碼，你會發現沒有註釋的話你會在自己的代碼中迷失！所以我們的新程序第一行以下列註釋開始：

```lua
-- 我的第一個 Lua 程序
-- 作者: 你的名字
```

正如你看到的，註釋以雙劃線開始（ -- ）。在此之後輸入的任何文字都不會被視為代碼，在執行時將被完全忽略掉。但是，請注意，你必須保持註釋在一行內。如果你用回車到了下一行，請記住也要用雙劃線起頭。參照我們上面給出的代碼，你應該已經知道怎麼做註釋了。不難吧，是不是？

> 譯者註：多行註釋以 --[[ 開頭，]] 結尾。如下：

```lua
--[[
*********************************************
* 廬~山~升~龍~霸 *
* 天~馬~流~星~拳 *
*********************************************
]]
```

## 建立一個色彩對象

接下來我們將建立一個色彩對象，以便列印文字到螢幕上。我們將為此指定一個特定顏色然後用於print命令。將下面的代碼加入到你的程序中，記得要另起一行。你也可以多空一行以便和上面的註釋隔開。

警告：Lua是區分大小寫的，也就是說所有命令必須按照我們顯示的大小寫輸入。例如下述代碼中如果“Color”被打成“color”的話將無法運行。

```lua
red = Color.new(255, 0, 0)
```

這樣我們就建立了一個色彩對象。我們使用RGB值指定顏色，並將其存為一個變數red。你可以通過任何圖像編輯程序獲得任意顏色的RGB值。變數 red 儲存了指定的色彩訊息，但是這不意味著只要把它換成“blue”就會變成藍色。變數名與其指代的顏色毫無關係。顏色來自RGB值。所以，你把red改成BigFatTurkey也沒有關係。如果你還是不理解何謂變數，不用著急。我們很快就會專門學習它的。

## 列印至螢幕

哈，到我們程序最精彩的部分了。我們將使用print命令列印一些文字到螢幕上。將下述代碼複製到你的程式碼末尾。

```lua
screen:print(200, 100, "Look! I made text appear!", red)
```

讓我們對此解析一下。screen:print就是告訴我們的程序列印一些東西到螢幕上。在其後的括號裡你看到有幾個數值。這些值稱為參數，每個函數所帶的參數其個數和類型都不同。對於print來說我們調用了4個參數。

它的語法結構: `screen:print( x, y, stringOfText, colorObject)`

* 第一個參數，x，告訴程序在距離螢幕左側多少像素的地方列印文字。

* 第二個參數，y，告訴程序在距離螢幕頂端多少像素的地方列印文字。

* 第三個參數，就是你打算讓程序列印的文字。記得用引號把文字括起來。

* 至於第四個...嘿，那就是我們早先建立的色彩對象red！這告訴程序使用紅色列印文字，該色彩是我們先前建立的。記住在print語句使用顏色之前你必須先建立它！

## 離屏快取轉至顯屏

下述代碼可能有點讓人迷惑。但是別擔心，即使你不完全理解它，也沒什麼關係。原樣照抄到你代碼的最後一行就是，象之前一樣。

```lua
screen.flip()
```

簡單的說，所有的東西都是先在屏下繪製的，所以我們必須使用此命令讓它顯示到螢幕上面。

## 一個循環？

沒錯，接下來我們要建立一個程序循環。它讓一段代碼循環執行直至某事讓它停止。在本例中使用循環是為了讓我們的程序不至於顯示完文字就結束。沒有這個循環的話，我們根本沒機會看到文字，因為程序結束的太快了。下面是代碼，我想你現在知道該放哪裡了吧。

```lua
while true do
screen.waitVblankStart()
end
```

以後我們會深入探討循環的。現在你只要知道它必須在那裡！

到此我們的第一個程序完成！保存你的代碼文件，雙擊 `script.cmd` 運行你的程序。如果一切順利你應該在螢幕上看到你的紅色文本了。
